@using Application.Domain.ApplicationEntities
@using Application.Web.ViewModels
@model ViewModelWithPagination<Thread, RepliesViewModel>
@{
    Layout = "_Layout";
}
<br />
<br />
<br />
<br />

<div class="container">
    <div>
        <h1>@Model.PageData.Heading</h1>
        <h3>By @Model.PageData.User.FirstName @Model.PageData.User.LastName @Model.PageData.DateTime</h3>
        <h4>@Model.PageData.Body</h4>
    </div>
    <div class="display: flex;">
        <button name="btnLike" id="btnLike_@Model.PageData.Id" value=@Model.PageData.Id><span class="glyphicon glyphicon-thumbs-up"></span></button>
        <span id="likeAvatarDisplaySpan1_@Model.PageData.Id"><img src="" id="likeAvatarDisplay1_@Model.PageData.Id" style="border-radius:50%;width:30px;height:30px;z-index:1;" /></span>
        <span id="likeAvatarDisplaySpan2_@Model.PageData.Id"><img src="" id="likeAvatarDisplay2_@Model.PageData.Id" style="border-radius:50%;width:30px;height:30px;z-index:0;" /></span>
        <span id="likeAvatarDisplaySpan3_@Model.PageData.Id"><img src="" id="likeAvatarDisplay3_@Model.PageData.Id" style="border-radius:50%;width:30px;height:30px;z-index:-1;" /></span>
        <span name="spnLikeCount" id="spnLikeCount_@Model.PageData.Id" value="@Model.PageData.Id"></span>
    </div>
    <div>
        <form action="/Forum/CreatePost" method="post">
            @Html.AntiForgeryToken()
            <input type="text" placeholder="Enter your comment here" name="content" />
            <input type="hidden" name="threadId" value="@Model.PageData.Id" />
            <button class="btn btn-primary" type="submit">Submit</button>
        </form>
    </div>
    <br /><br />
    <div>
        @foreach (var post in Model.PaginationData.ItemsToDisplay)
        {
            <div style="margin-left:5%">
                <b>@post.TopLevelPost.User.FirstName @post.TopLevelPost.User.LastName commented on @post.TopLevelPost.DateTime</b>
                <p>@post.TopLevelPost.Content</p>
                <hr />
            </div>

            @foreach (var reply in post.Replies)
            {
                <div style="margin-left:15%">
                    <b>@reply.User.FirstName @reply.User.LastName commented on @reply.DateTime</b>
                    <p>@reply.Content</p>
                    <hr />
                    <form action="/Forum/CreatePost" method="post">
                        @Html.AntiForgeryToken()
                        <input type="text" placeholder="Enter your comment here" name="content" />
                        <input type="hidden" name="threadId" value="@Model.PageData.Id" />
                        <input type="hidden" name="ParentPostId" value="@reply.Id" />
                        <button class="btn btn-primary" type="submit">Submit</button>
                    </form>
                </div>
            }


            <form action="/Forum/CreatePost" method="post">
                @Html.AntiForgeryToken()
                <input type="text" placeholder="Enter your comment here" name="content" />
                <input type="hidden" name="threadId" value="@Model.PageData.Id" />
                <input type="hidden" name="ParentPostId" value="@post.TopLevelPost.Id" />
                <button class="btn btn-primary" type="submit">Submit</button>
            </form>
        }
    </div>
    @await Html.PartialAsync("_PaginationWithId", Model.PaginationData)
</div>